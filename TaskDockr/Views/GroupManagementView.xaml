<UserControl
    x:Class="TaskDockr.Views.GroupManagementView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:models="clr-namespace:TaskDockr.Models">

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <!-- Header -->
        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,16">
            <Button Content="←" Width="32" Height="32" Margin="0,0,12,0"
                    Style="{StaticResource IconButtonStyle}"
                    Click="OnBackClick" />
            <TextBlock Text="Manage Groups" FontSize="20" FontWeight="SemiBold"
                       VerticalAlignment="Center"
                       Foreground="{DynamicResource TextFillColorPrimaryBrush}" />
        </StackPanel>

        <!-- Groups list -->
        <ListBox Grid.Row="1"
                 ItemsSource="{Binding Groups}"
                 SelectedItem="{Binding SelectedGroup, Mode=TwoWay}"
                 Background="Transparent"
                 BorderThickness="0">
            <ListBox.ItemContainerStyle>
                <Style TargetType="ListBoxItem">
                    <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                    <Setter Property="Padding"    Value="8,6" />
                    <Setter Property="Margin"     Value="0,3" />
                    <Setter Property="Background" Value="Transparent" />
                </Style>
            </ListBox.ItemContainerStyle>
            <ListBox.ItemTemplate>
                <DataTemplate DataType="{x:Type models:Group}">
                    <Border Background="{DynamicResource CardBackgroundFillColorDefaultBrush}"
                            BorderBrush="{DynamicResource ControlStrokeColorDefaultBrush}"
                            BorderThickness="1" CornerRadius="6" Padding="12,8">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="{Binding Name}" FontWeight="SemiBold" FontSize="14"
                                           Foreground="{DynamicResource TextFillColorPrimaryBrush}" />
                                <TextBlock Text="{Binding Shortcuts.Count, Converter={StaticResource CountToShortcutsConverter}}"
                                           FontSize="11" Opacity="0.7"
                                           Foreground="{DynamicResource TextFillColorSecondaryBrush}" />
                            </StackPanel>
                            <Button Grid.Column="1" Content="✎" Width="28" Height="28" Margin="4,0"
                                    Command="{Binding DataContext.EditGroupCommand,
                                        RelativeSource={RelativeSource AncestorType=UserControl}}"
                                    CommandParameter="{Binding}"
                                    Style="{StaticResource IconButtonStyle}" />
                            <Button Grid.Column="2" Content="✕" Width="28" Height="28"
                                    Command="{Binding DataContext.DeleteGroupCommand,
                                        RelativeSource={RelativeSource AncestorType=UserControl}}"
                                    CommandParameter="{Binding}"
                                    Style="{StaticResource IconButtonStyle}" />
                        </Grid>
                    </Border>
                </DataTemplate>
            </ListBox.ItemTemplate>
        </ListBox>

        <!-- Footer -->
        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,12,0,0">
            <Button Content="Add Group" Margin="0,0,8,0"
                    Command="{Binding AddGroupCommand}"
                    Style="{StaticResource AccentButtonStyle}" />
            <Button Content="Back" Click="OnBackClick"
                    Style="{StaticResource DefaultButtonStyle}" />
        </StackPanel>
    </Grid>
</UserControl>
